---
title: DrizzleORM v0.16.2 ë¦´ë¦¬ìŠ¤
pubDate: 2023-01-21
description: Drizzle ORMì€ SQL ìŠ¤í‚¤ë§ˆì™€ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±ì„ ìœ„í•œ CLIì˜ ì§„ì‹¤ì˜ ì›ì²œìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ORMì´ì ì¿¼ë¦¬ ë¹Œë”ì…ë‹ˆë‹¤.
---
import Section from "@mdx/Section.astro";

Drizzle ORMì€ SQL ìŠ¤í‚¤ë§ˆì™€ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±ì„ ìœ„í•œ CLIì˜ ì§„ì‹¤ì˜ ì›ì²œìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ORMì´ì ì¿¼ë¦¬ ë¹Œë”ì…ë‹ˆë‹¤.

ì§€ë‚œ ì£¼ìš” ì—…ë°ì´íŠ¸ ì´í›„ë¡œ ë§ì€ ìš”ì²­ëœ ê¸°ëŠ¥ë“¤ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸš€

### ğŸ‰ PostgreSQL ìŠ¤í‚¤ë§ˆ

ì´ì œ [PostgreSQL ìŠ¤í‚¤ë§ˆ](https://www.postgresql.org/docs/current/ddl-schemas.html)ë¥¼ ì„ ì–¸í•˜ê³ , í•´ë‹¹ ìŠ¤í‚¤ë§ˆ ë‚´ì— ìƒì„±ë  í…Œì´ë¸”ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<Section>
```ts copy
// src/schema.ts
import { pgSchema } from "drizzle-orm-pg";

export const mySchema = pgSchema("my_schema");

export const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});
```
```sql
CREATE SCHEMA "my_schema";

CREATE TABLE IF NOT EXISTS "my_schema"."users" (
	"id" serial PRIMARY KEY NOT NULL,
	"name" text,
	"email" text
);
```
</Section>

[drizzle-kit](https://driz.link/kit)ì€ í•„ìš”í•œ ëª¨ë“  SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

```shell 
drizzle-kit generate:pg --schema=src/schema.ts --out=migrations/ 
```


### ğŸ‰ MySQL ë°ì´í„°ë² ì´ìŠ¤/ìŠ¤í‚¤ë§ˆ

ì´ì œ [MySQL ë°ì´í„°ë² ì´ìŠ¤/ìŠ¤í‚¤ë§ˆ](https://dev.mysql.com/doc/refman/8.0/en/create-database.html)ì™€ ê·¸ ì•ˆì— ìƒì„±í•  í…Œì´ë¸”ì„ ì„ ì–¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts copy
// schema.ts
import { mysqlSchema } from "drizzle-orm-mysql";

const mySchema = mysqlSchema("my_schema");

const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});
```

[drizzle-kit](https://driz.link/kit)ì€ í•„ìš”í•œ ëª¨ë“  SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

```shell
drizzle-kit generate:mysql --schema=src/schema.ts --out=migrations/
```

ì´ ëª…ë ¹ì–´ëŠ” ìë™ìœ¼ë¡œ SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.

```sql
CREATE DATABASE `my_schema`;

CREATE TABLE `my_schema`.`users` (
	`id` serial PRIMARY KEY NOT NULL,
	`name` text,
	`email` text
);
```


### ğŸ‰ PostgreSQL ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ ê¸°ëŠ¥ ì†Œê°œ

ì´ì œ [drizzle-kit](https://driz.link/kit)ì„ ì‚¬ìš©í•´ ê¸°ì¡´ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ëª‡ ì´ˆ ë§Œì— ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ê¸°ì¡´ ORMì´ë‚˜ ì¼ë°˜ SQLì—ì„œ ì „í™˜í•  ë•Œ ë°œìƒí•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ë²ˆê±°ë¡œì›€ì„ ì—†ì• ì¤ë‹ˆë‹¤. ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- ì—´ê±°í˜•(enum)
- ëª¨ë“  ê¸°ë³¸ ë° ë¹„ê¸°ë³¸ ì»¬ëŸ¼ì„ í¬í•¨í•œ í…Œì´ë¸”
- ì¸ë±ìŠ¤
- ì™¸ë˜ í‚¤, ìê¸° ì°¸ì¡° ë° ìˆœí™˜ ì™¸ë˜ í‚¤
- ìŠ¤í‚¤ë§ˆ

```shell
drizzle-kit introspect:pg --out=migrations/ --connectionString=postgresql://user:pass@host:port/db_name
```

ìœ„ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ `schema.ts` íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

```ts
export const myEnum = pgEnum("my_enum", ["one", "two", "three"]);
export const mySchema = pgSchema("my_schema");

export const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});

export const users2 = pgTable("users2", {
  id: serial("id").primaryKey(),
  name: varchar("name2"),
  enum: myEnum("enum"),
});

export const allColumns = pgTable("all_columns", {
  sm: smallint("smallint"),
  smdef: smallint("smallint_def").default(10),
  int: integer("integer"),
  intdef: integer("integer_def").default(10),
  numeric: numeric("numeric"),
  numeric2: numeric("numeric2", { precision: 7 }),
  numeric3: numeric("numeric3", { scale: 7 }),
  numeric4: numeric("numeric4", { precision: 7, scale: 7 }),
  numericdef: numeric("numeridef").default("100"),
  bigint: bigint("bigint", { mode: "number" }),
  bigintdef: bigint("bigint", { mode: "number" }).default(100),
  bool: boolean("boolean"),
  booldef: boolean("boolean_def").default(true),
  text: text("text"),
  textdef: text("textdef").default("text"),
  varchar: varchar("varchar"),
  varchardef: varchar("varchardef").default("text"),
  serial: serial("serial"),
  bigserial: bigserial("bigserial", { mode: "bigint" }),
  decimal: decimal("decimal", { precision: 100, scale: 2 }),
  decimaldef: decimal("decimaldef", { precision: 100, scale: 2 }).default(
    "100.0",
  ),
  doublePrecision: doublePrecision("decimal"),
  doublePrecisiondef: doublePrecision("decimaldef").default(100.0),
  real: real("real"),
  realdef: real("decimaldef").default(100.0),
  json: json("json"),
  jsondef: json("jsondef").default({ attr: "value" }),
  jsonb: jsonb("jsonb"),
  jsonbdef: jsonb("jsonbdef").default({ attr: "value" }),
  time: time("time"),
  time2: time("time2", { precision: 6, withTimezone: true }),
  timedefnow: time("timedefnow").defaultNow(),
  timestamp: timestamp("timestamp"),
  timestamp2: timestamp("timestamp2", { precision: 6, withTimezone: true }),
  timestamp3: timestamp("timestamp3", { withTimezone: true }),
  timestamp4: timestamp("timestamp4", { precision: 4 }),
  timestampdef: timestamp("timestampdef").defaultNow(),
  date: date("date", { mode: "date" }),
  datedef: date("datedef").defaultNow(),
  interval: interval("interval"),
  intervaldef: interval("intervaldef").default("10 days"),
});

export const cyclic1 = pgTable("cyclic1", {
  id: serial("id").primaryKey(),
  ext2: integer("ext2").references(() => cyclic2.id),
});

export const cyclic2 = pgTable("cyclic2", {
  id: serial("id").primaryKey(),
  ext1: integer("ext1").references((): AnyPgColumn => cyclic1.id),
});

export const example = pgTable(
  "example",
  {
    id: serial("id").primaryKey(),
    reportsTo: integer("reports_to"),
  },
  (table) => {
    return {
      reportsToFK: foreignKey({
        columns: [table.reportsTo],
        foreignColumns: [table.id],
      }),
    };
  },
);
```


### ğŸ‰ Postgres.js ë“œë¼ì´ë²„ ì§€ì› ì¶”ê°€

ì´ì œ [postgres.js](https://github.com/porsager/postgres)ë¥¼ ì™„ë²½í•˜ê²Œ ì§€ì›í•©ë‹ˆë‹¤. ê°€ë³ê³  ë¹ ë¥¸ ë“œë¼ì´ë²„ì…ë‹ˆë‹¤ ğŸš€

```ts copy
// schema.ts
import { pgTable, serial, text, varchar } from "drizzle-orm-pg";
export const users = pgTable("users", {
  id: serial("id").primaryKey(),
  fullName: text("full_name"),
  phone: varchar("phone", { length: 256 }),
});

// index.ts
import { drizzle, PostgresJsDatabase } from "drizzle-orm-pg/postgres.js";
import postgres from "postgres";
import { users } from "./schema";

const client = postgres(connectionString);
const db: PostgresJsDatabase = drizzle(client);

const allUsers = await db.select(users);
```

PostgreSQL ì „ì²´ ë¬¸ì„œëŠ” [ì—¬ê¸°](https://github.com/drizzle-team/drizzle-orm/tree/main/drizzle-orm-pg)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ‰ PostgreSQLê³¼ MySQL íƒ€ì…

ì—¬ëŸ¬ë¶„ì´ í•„ìš”í•œ ë¹„ë„¤ì´í‹°ë¸Œ PostgreSQL ë˜ëŠ” MySQL íƒ€ì…ì„ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ ìœ ìš©í•œ ì—°ì‚°ìë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

```ts copy
// PostgreSQL
const customText = customType({
  dataType() {
    return "text";
  },
});

const usersTable = pgTable("users", {
  name: customText("name").notNull(),
});

// MySQL
const customText = customType({
  dataType() {
    return "text";
  },
});

const usersTable = mysqlTable("users", {
  name: customText("name").notNull(),
});
```


