---
title: DrizzleORM v0.29.0 ë¦´ë¦¬ìŠ¤
pubDate: 2023-11-09
description: MySQLì—ì„œ bigintì— ëŒ€í•œ unsigned ì˜µì…˜ ì¶”ê°€, ì¿¼ë¦¬ ë¹Œë” íƒ€ì… ê°œì„ , ê¸°ë³¸ í‚¤ì™€ ì™¸ë˜ í‚¤ì— ì´ë¦„ ì§€ì • ê°€ëŠ¥, ì½ê¸° ì „ìš© ë³µì œë³¸ ì§€ì›, ì§‘í•© ì—°ì‚°ì ì§€ì›, ìƒˆë¡œìš´ MySQL ë° PostgreSQL í”„ë¡ì‹œ ë“œë¼ì´ë²„, D1 Batch API ì§€ì› ë“± ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€.
---
import Section from "@mdx/Section.astro";

> Drizzle ORM ë²„ì „ `0.29.0`ì€ ìµœì†Œ Drizzle Kit ë²„ì „ `0.20.0`ì„ í•„ìš”ë¡œ í•˜ë©°, ê·¸ ë°˜ëŒ€ë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤. ë”°ë¼ì„œ Drizzle ORMì„ ìƒˆ ë²„ì „ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•  ë•Œ Drizzle Kitë„ í•¨ê»˜ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ë²„ì „ ê°„ì— ì¼ë¶€ í˜¸í™˜ì„±ì´ ê¹¨ì§€ëŠ” ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, íŠ¹íˆ Drizzle Kitì„ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í•˜ê³  Drizzle ORM ë²„ì „ì´ `<0.28.0`ë³´ë‹¤ ë‚®ì€ ê²½ìš° ë”ìš± ê·¸ë ‡ìŠµë‹ˆë‹¤.

## ìƒˆë¡œìš´ ê¸°ëŠ¥

### ğŸ‰ MySQL `bigint` íƒ€ì…ì— `unsigned` ì˜µì…˜ ì¶”ê°€

ì´ì œ `bigint unsigned` íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts copy {2}
const table = mysqlTable('table', {
  id: bigint('id', { mode: 'number', unsigned: true }),
});
```

ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/column-types/mysql#bigint)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.


### ğŸ‰ ê°œì„ ëœ ì¿¼ë¦¬ ë¹Œë” íƒ€ì…

`0.29.0` ë²„ì „ë¶€í„°, Drizzleì˜ ëª¨ë“  ì¿¼ë¦¬ ë¹Œë”ëŠ” SQLì— ìµœëŒ€í•œ ë¶€í•©í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ëŒ€ë¶€ë¶„ì˜ ë©”ì„œë“œëŠ” í•œ ë²ˆë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, SELECT ë¬¸ì—ì„œëŠ” WHERE ì ˆì´ í•˜ë‚˜ë§Œ ì¡´ì¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ `.where()` ë©”ì„œë“œëŠ” í•œ ë²ˆë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts copy {5}
const query = db
  .select()
  .from(users)
  .where(eq(users.id, 1))
  .where(eq(users.name, 'John')); // âŒ íƒ€ì… ì—ëŸ¬ - where()ì€ í•œ ë²ˆë§Œ í˜¸ì¶œ ê°€ëŠ¥
```

ì´ëŸ¬í•œ ë™ì‘ì€ ì „ì²´ ì¿¼ë¦¬ë¥¼ í•œ ë²ˆì— ìƒì„±í•˜ëŠ” ì „í†µì ì¸ ì¿¼ë¦¬ ë¹Œë”©ì— ìœ ìš©í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì¿¼ë¦¬ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ë ¤ëŠ” ê²½ìš°, ì˜ˆë¥¼ ë“¤ì–´ ì¿¼ë¦¬ ë¹Œë”ë¥¼ ë°›ì•„ì„œ ì¶”ê°€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ê³µìœ  í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œ ë¬¸ì œê°€ ë©ë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Drizzleì€ ì¿¼ë¦¬ ë¹Œë”ì— 'ë™ì ' ëª¨ë“œë¥¼ ì œê³µí•˜ë©°, ì´ ëª¨ë“œì—ì„œëŠ” ë©”ì„œë“œë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª¨ë“œë¥¼ í™œì„±í™”í•˜ë ¤ë©´ ì¿¼ë¦¬ ë¹Œë”ì—ì„œ `.$dynamic()`ì„ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.

í˜ì´ì§€ ë²ˆí˜¸ì™€ ì„ íƒì ì¸ í˜ì´ì§€ í¬ê¸°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ LIMIT ë° OFFSET ì ˆì„ ì¶”ê°€í•˜ëŠ” ê°„ë‹¨í•œ `withPagination` í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤:

```ts copy {12,13}
function withPagination(
  qb: T,
  page: number,
  pageSize: number = 10,
) {
  return qb.limit(pageSize).offset(page * pageSize);
}

const query = db.select().from(users).where(eq(users.id, 1));
withPagination(query, 1); // âŒ íƒ€ì… ì—ëŸ¬ - ì¿¼ë¦¬ ë¹Œë”ê°€ ë™ì  ëª¨ë“œê°€ ì•„ë‹˜

const dynamicQuery = query.$dynamic();
withPagination(dynamicQuery, 1); // âœ… ì •ìƒ ë™ì‘
```

`withPagination` í•¨ìˆ˜ëŠ” ì œë„¤ë¦­ í•¨ìˆ˜ë¡œ, ì¿¼ë¦¬ ë¹Œë”ì˜ ê²°ê³¼ íƒ€ì…ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¡°ì¸ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts copy {2}
function withFriends(qb: T) {
  return qb.leftJoin(friends, eq(friends.userId, users.id));
}

let query = db.select().from(users).where(eq(users.id, 1)).$dynamic();
query = withFriends(query);
```

ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/dynamic-query-building)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ‰ ê¸°ë³¸ í‚¤ì™€ ì™¸ë˜ í‚¤ì— ì´ë¦„ ì§€ì • ê°€ëŠ¥

ë°ì´í„°ë² ì´ìŠ¤ì˜ ì œì•½ ì¡°ê±´ ì´ë¦„ì´ 64ì ì œí•œì„ ì´ˆê³¼í•  ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§„ì´ ì´ë¦„ì„ ì˜ë¼ë‚´ì–´ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. `0.29.0` ë²„ì „ë¶€í„°ëŠ” `primaryKey()`ì™€ `foreignKey()`ì— ì»¤ìŠ¤í…€ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ê¸°ì¡´ì˜ `primaryKey()` êµ¬ë¬¸ì€ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šì„ ì˜ˆì •ì´ë©°, í–¥í›„ ë¦´ë¦¬ìŠ¤ì—ì„œ ì œê±°ë  ì˜ˆì •ì…ë‹ˆë‹¤.

```ts copy {5,7}
const table = pgTable('table', {
  id: integer('id'),
  name: text('name'),
}, (table) => ({
  cpk: primaryKey({ name: 'composite_key', columns: [table.id, table.name] }),
  cfk: foreignKey({
    name: 'fkName',
    columns: [table.id],
    foreignColumns: [table.name],
  }),
}));
```

ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/indexes-constraints#composite-primary-key)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ‰ ì½ê¸° ì „ìš© ë³µì œë³¸(Read Replicas) ì§€ì›

ì´ì œ Drizzleì˜ `withReplica` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì½ê¸° ì „ìš© ë³µì œë³¸ê³¼ ì“°ê¸° ì‘ì—…ì„ ìœ„í•œ ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ê°ê° ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ `withReplicas`ëŠ” ì½ê¸° ì‘ì—… ì‹œ ëœë¤ìœ¼ë¡œ ì½ê¸° ì „ìš© ë³µì œë³¸ì„ ì‚¬ìš©í•˜ê³ , ë°ì´í„° ìˆ˜ì • ì‘ì—…ì—ëŠ” ë©”ì¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ, ì–´ë–¤ ì½ê¸° ì „ìš© ë³µì œë³¸ ì—°ê²°ì„ ì‚¬ìš©í• ì§€ ì„ íƒí•˜ëŠ” ì»¤ìŠ¤í…€ ë¡œì§ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì€ ê°€ì¤‘ì¹˜ë¥¼ ì ìš©í•˜ê±°ë‚˜ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„ íƒ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì‚¬ìš© ì˜ˆì œì…ë‹ˆë‹¤:

```ts copy {5}
const primaryDb = drizzle({ client });
const read1 = drizzle({ client });
const read2 = drizzle({ client });

const db = withReplicas(primaryDb, [read1, read2]);

// ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì½ê¸°
db.$primary.select().from(usersTable);

// read1 ë˜ëŠ” read2 ì—°ê²° ì¤‘ í•˜ë‚˜ì—ì„œ ì½ê¸°
db.select().from(usersTable)

// ì‚­ì œ ì‘ì—…ì€ ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìˆ˜í–‰
db.delete(usersTable).where(eq(usersTable.id, 1))
```

ì•„ë˜ëŠ” ì½ê¸° ì „ìš© ë³µì œë³¸ ì„ íƒì„ ìœ„í•œ ì»¤ìŠ¤í…€ ë¡œì§ êµ¬í˜„ ì˜ˆì œì…ë‹ˆë‹¤. ì²« ë²ˆì§¸ ë³µì œë³¸ì´ 70% í™•ë¥ ë¡œ ì„ íƒë˜ê³ , ë‘ ë²ˆì§¸ ë³µì œë³¸ì€ 30% í™•ë¥ ë¡œ ì„ íƒë©ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì€ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ëœë¤ ì„ íƒ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts copy
const db = withReplicas(primaryDb, [read1, read2], (replicas) => {
    const weight = [0.7, 0.3];
    let cumulativeProbability = 0;
    const rand = Math.random();

    for (const [i, replica] of replicas.entries()) {
      cumulativeProbability += weight[i]!;
      if (rand < cumulativeProbability) return replica;
    }
    return replicas[0]!
});
```

`withReplicas` í•¨ìˆ˜ëŠ” Drizzle ORMì˜ ëª¨ë“  ë‹¤ì´ì–¼ë ‰íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/read-replicas)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.


### ğŸ‰ ì§‘í•© ì—°ì‚°ì ì§€ì› (UNION, UNION ALL, INTERSECT, INTERSECT ALL, EXCEPT, EXCEPT ALL)

@Angelelzì—ê²Œ í° ê°ì‚¬ë¥¼ ë“œë¦½ë‹ˆë‹¤. API ë…¼ì˜ë¶€í„° ì ì ˆí•œ íƒ€ì… ê²€ì‚¬ì™€ ëŸ°íƒ€ì„ ë¡œì§, ê·¸ë¦¬ê³  ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ê¹Œì§€ ë§ì€ ê¸°ì—¬ë¥¼ í•´ì£¼ì…¨ìŠµë‹ˆë‹¤. ë•ë¶„ì— ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì—ì„œ ì´ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

**ì‚¬ìš© ì˜ˆì œ:**
ëª¨ë“  ì§‘í•© ì—°ì‚°ìëŠ” ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `import ë°©ì‹` ë˜ëŠ” `builder ë°©ì‹`

<Section>
```ts copy {2,7}
// Import ë°©ì‹
import { union } from 'drizzle-orm/pg-core'

const allUsersQuery = db.select().from(users);
const allCustomersQuery = db.select().from(customers);

const result = await union(allUsersQuery, allCustomersQuery)
```

```ts copy {2}
// Builder ë°©ì‹
const result = await db.select().from(users).union(db.select().from(customers));
```
</Section>

ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/set-operations)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.


### ğŸ‰ ìƒˆë¡œìš´ MySQL í”„ë¡ì‹œ ë“œë¼ì´ë²„

MySQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ HTTP ë“œë¼ì´ë²„ë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ë“œë¼ì´ë²„ê°€ ì¶œì‹œë˜ì—ˆìŠµë‹ˆë‹¤. ì‚¬ìš© ì˜ˆì œëŠ” `./examples/mysql-proxy` í´ë”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ì— ì¿¼ë¦¬ì™€ ë§ˆì´ê·¸ë ˆì´ì…˜(ë§ˆì´ê·¸ë ˆì´ì…˜ ì—”ë“œí¬ì¸íŠ¸ëŠ” ì„ íƒ ì‚¬í•­ì´ë©°, Drizzle ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‚¬ìš©í•˜ë ¤ëŠ” ê²½ìš°ì—ë§Œ í•„ìš”)ì„ ì²˜ë¦¬í•  ë‘ ê°œì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. ì„œë²„ì™€ ë“œë¼ì´ë²„ êµ¬í˜„ì€ ì—¬ëŸ¬ë¶„ì˜ ììœ ì— ë§¡ê²¨ì ¸ ìˆìœ¼ë¯€ë¡œ, ì»¤ìŠ¤í…€ ë§¤í•‘, ë¡œê¹… ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ì™€ ë“œë¼ì´ë²„ êµ¬í˜„ ì˜ˆì œëŠ” `./examples/mysql-proxy` í´ë”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts copy {4,9}
// ë“œë¼ì´ë²„
import axios from 'axios';
import { eq } from 'drizzle-orm/expressions';
import { drizzle } from 'drizzle-orm/mysql-proxy';
import { migrate } from 'drizzle-orm/mysql-proxy/migrator';
import { cities, users } from './schema';

async function main() {
  const db = drizzle(async (sql, params, method) => {
    try {
      const rows = await axios.post(`${process.env.REMOTE_DRIVER}/query`, {
        sql,
        params,
        method,
      });

      return { rows: rows.data };
    } catch (e: any) {
      console.error('í”„ë¡ì‹œ ì„œë²„ì—ì„œ ì˜¤ë¥˜ ë°œìƒ:', e.response.data);
      return { rows: [] };
    }
  });

  await migrate(db, async (queries) => {
    try {
      await axios.post(`${process.env.REMOTE_DRIVER}/migrate`, { queries });
    } catch (e) {
      console.log(e);
      throw new Error('í”„ë¡ì‹œ ì„œë²„ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }
  }, { migrationsFolder: 'drizzle' });

  await db.insert(cities).values({ id: 1, name: 'name' });

  await db.insert(users).values({
    id: 1,
    name: 'name',
    email: 'email',
    cityId: 1,
  });

  const usersToCityResponse = await db.select().from(users).leftJoin(
    cities,
    eq(users.cityId, cities.id),
  );
}
```

ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/get-started-mysql#http-proxy)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ‰ ìƒˆë¡œìš´ PostgreSQL í”„ë¡ì‹œ ë“œë¼ì´ë²„

MySQLê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, ì´ì œ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìœ„í•œ HTTP ë“œë¼ì´ë²„ë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš© ì˜ˆì œëŠ” `./examples/pg-proxy` í´ë”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ì—ì„œ ì¿¼ë¦¬ì™€ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì²˜ë¦¬í•  ë‘ ê°œì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. (ë§ˆì´ê·¸ë ˆì´ì…˜ ì—”ë“œí¬ì¸íŠ¸ëŠ” ì„ íƒ ì‚¬í•­ì´ë©°, Drizzle ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‚¬ìš©í•˜ë ¤ëŠ” ê²½ìš°ì—ë§Œ í•„ìš”í•©ë‹ˆë‹¤.) ì„œë²„ì™€ ë“œë¼ì´ë²„ êµ¬í˜„ì€ ì—¬ëŸ¬ë¶„ì˜ ììœ ì— ë§¡ê²¨ì ¸ ìˆìœ¼ë¯€ë¡œ, ì»¤ìŠ¤í…€ ë§¤í•‘, ë¡œê¹… ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ì™€ ë“œë¼ì´ë²„ êµ¬í˜„ ì˜ˆì œëŠ” `./examples/pg-proxy` í´ë”ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts copy {3,8}
import axios from 'axios';
import { eq } from 'drizzle-orm/expressions';
import { drizzle } from 'drizzle-orm/pg-proxy';
import { migrate } from 'drizzle-orm/pg-proxy/migrator';
import { cities, users } from './schema';

async function main() {
  const db = drizzle(async (sql, params, method) => {
    try {
      const rows = await axios.post(`${process.env.REMOTE_DRIVER}/query`, { sql, params, method });

      return { rows: rows.data };
    } catch (e: any) {
      console.error('Error from pg proxy server:', e.response.data);
      return { rows: [] };
    }
  });

  await migrate(db, async (queries) => {
    try {
      await axios.post(`${process.env.REMOTE_DRIVER}/query`, { queries });
    } catch (e) {
      console.log(e);
      throw new Error('Proxy server cannot run migrations');
    }
  }, { migrationsFolder: 'drizzle' });

  const insertedCity = await db.insert(cities).values({ id: 1, name: 'name' }).returning();
  const insertedUser = await db.insert(users).values({ id: 1, name: 'name', email: 'email', cityId: 1 });
  const usersToCityResponse = await db.select().from(users).leftJoin(cities, eq(users.cityId, cities.id));
}
```

ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¬¸ì„œ](/docs/get-started-postgresql#http-proxy)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ‰ `D1` ë°°ì¹˜ API ì§€ì›

ì°¸ê³ : https://developers.cloudflare.com/d1/platform/client-api/#dbbatch

ë°°ì¹˜ API ì‚¬ìš© ì˜ˆì œ:

<Section>
```ts copy {1}
const batchResponse = await db.batch([
  db.insert(usersTable).values({ id: 1, name: 'John' }).returning({
    id: usersTable.id,
  }),
  db.update(usersTable).set({ name: 'Dan' }).where(eq(usersTable.id, 1)),
  db.query.usersTable.findMany({}),
  db.select().from(usersTable).where(eq(usersTable.id, 1)),
  db.select({ id: usersTable.id, invitedBy: usersTable.invitedBy }).from(
    usersTable,
  ),
]);
```

```ts
type BatchResponse = [
  {
    id: number;
  }[],
  D1Result,
  {
    id: number;
    name: string;
    verified: number;
    invitedBy: number | null;
  }[],
  {
    id: number;
    name: string;
    verified: number;
    invitedBy: number | null;
  }[],
  {
    id: number;
    invitedBy: number | null;
  }[],
];
```
</Section>

`db.batch` ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ë¹Œë”:

```ts
`db.all()`,
`db.get()`,
`db.values()`,
`db.run()`,
`db.query..findMany()`,
`db.query..findFirst()`,
`db.select()...`,
`db.update()...`,
`db.delete()...`,
`db.insert()...`,
```

ë” ë§ì€ ì‚¬ìš© ì˜ˆì œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [integration-tests/tests/d1-batch.test.ts](https://github.com/drizzle-team/drizzle-orm/blob/beta/integration-tests/tests/d1-batch.test.ts) ê·¸ë¦¬ê³  [ë¬¸ì„œ](/docs/batch-api)ì—ì„œë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---


## Drizzle Kit 0.20.0 ì—…ë°ì´íŠ¸

1. **`defineConfig` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ drizzle.config ì •ì˜í•˜ëŠ” ìƒˆë¡œìš´ ë°©ì‹**  
   ì´ì œ `defineConfig` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì„¤ì • íŒŒì¼ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **wrangler.toml íŒŒì¼ì„ í†µí•´ Drizzle Studioì—ì„œ Cloudflare D1 ì ‘ê·¼ ê°€ëŠ¥**  
   Drizzle Studioì—ì„œ Cloudflare D1ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ `wrangler.toml` íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

3. **Drizzle Studioê°€ https://local.drizzle.studio/ë¡œ ì´ì „**  
   Drizzle Studioê°€ ìƒˆë¡œìš´ ë„ë©”ì¸ì¸ `https://local.drizzle.studio/`ë¡œ ì´ì „í–ˆìŠµë‹ˆë‹¤.

4. **`bigint unsigned` íƒ€ì… ì§€ì›**  
   ì´ì œ `bigint unsigned` íƒ€ì…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

5. **`primaryKeys`ì™€ `foreignKeys`ì— ì»¤ìŠ¤í…€ ì´ë¦„ ì§€ì • ê°€ëŠ¥**  
   ê¸°ë³¸ í‚¤ì™€ ì™¸ë˜ í‚¤ì— ì»¤ìŠ¤í…€ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

6. **í™˜ê²½ ë³€ìˆ˜ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°**  
   í™˜ê²½ ë³€ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

7. **ë²„ê·¸ ìˆ˜ì • ë° ê°œì„  ì‚¬í•­**  
   ì—¬ëŸ¬ ë²„ê·¸ê°€ ìˆ˜ì •ë˜ê³  ê¸°ëŠ¥ì´ ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.

ë” ìì„¸í•œ ë‚´ìš©ì€ [ì—¬ê¸°](https://github.com/drizzle-team/drizzle-kit-mirror/releases/tag/v0.20.0)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


